___
<center>
    <img src="png\woc0.jpg" alt="отцентрированное изображение" />
</center>

___

<h1 align="center"><b>«Цифровая обработка сигналов».</b></h1></li>

**Введение**

Цифровая обработка сигналов (ЦОС; английский термин – Digital Signal Processing, DSP) – это область знаний, которая занимается представлением дискретных во времени сигналов в виде последовательности чисел и обработкой этих сигналов. Алгоритмы цифровой обработки сигналов реализуются на различных аппаратных системах: персональные компьютеры, цифровые сигнальные процессоры, микроконтроллеры и т.д. Предмет ЦОС рассматривает, в основном, не оборудование для обработки сигналов, а математические модели (абстракции).

Цифровая обработка сигналов прошла большой путь развития, находя применения как в военной сфере (радиолокация, системы связи), так и в гражданских областях (обработка звука, изображений, видео, цифровые телекоммуникации и т.д). Такие преимущества ЦОС (по сравнению с аналоговыми системами), как высокая помехоустойчивость, возможность исправления ошибок при передаче сигнала, меньшие требования по ширине канала, возможность компрессии сигнала и временного разделения каналов делают цифровую обработку сигналов экономически привлекательной. В наше время сотовая телефония, цифровое телевидение и Интернет – наиболее быстро растущие области применения ЦОС. Поэтому понимание основ данного процесса важно для любого современного специалиста в области информационных технологий.
***
**1. Теоретическая часть**

Спектральный анализ является одним из самых мощных инструментов обработки сигналов. Он используется при фильтрации сигналов (подавлении шумов), при сжатии звуковой и видео информации и пр. Также спектральные подходы широко используются при анализе данных (обработка результатов эксперимента) для выявления характерных частот изменения искомых параметров.

Наиболее простым и привычным видом описания сигналов  является представление их в виде функций времени. Такое представление называют временным (ударение на последний слог) или координатным. Однако такое представление неудобно при анализе и обработке сигналов. Поэтому широко используются другие виды описания сигналов, главным среди которых является спектральное представление. Его возможность обусловлена тем, что любой сколь угодно сложный по своей форме сигнал можно представить в виде конечной или бесконечной суммы более простых сигналов – базисных функций (преобразование Фурье). В качестве базисных функций используют зависимости для простейших гармонических колебаний.

Разложение в ряд (преобразование) Фурье предполагает представление функции в виде суммы гармонических колебаний различной частоты и амплитуды.

Различают две формы записи тригонометрического ряда Фурье – вещественную и комплексную.

***1.1. Вещественная форма записи ряда Фурье.***

В этом случае элементы ряда являются функциями вещественного аргумента и представление сигнала **u(t)** имеет вид:

<center>
    <img src="png\001.jpg" alt="отцентрированное изображение" />
</center>			(1)

где  **ak** и **bk** - коэффициенты Фурье (постоянные величины); **k** – целое число.

При этом 

**wk = 2pk/T,**						(2)

где **T –** период функции **u(t)/**

Таким образом, исходный сигнал произвольной формы может быть представлен в виде суммы, состоящей из постоянного слагаемого (среднего значения) и некоторого множества гармонических слагаемых с частотами
**w** - основная частота, **2w** - 2-я гармоника, **3w** - 3-я гармоника и т.д.

Для периодической функции с периодом **Т** коэффициенты Фурье можно найти так:

![](png/002.png)		

![](png/003.png)		(3)

Разложение (1) можно представить в более компактной форме, объединив косинусные и синусные гармоники:

![](png/004.png)				(4)

где **sk, wk, jk** - постоянные величины, 

Для перехода от формы записи (1) к форме (4) можно использовать соотношения:

![](png/005.png)	

![](png/006.png)			(5)

где **Аk, wk, jk** - постоянные величины, 

Отдельное слагаемое суммы (4) **Ak×cos(wkt+jk)** называется **k**-ой простейшей составляющей (гармоникой) функции **u(t)**, которая характеризуется своей амплитудой **sk,**, угловой частотой **wk,** и начальным фазовым углом **jk**. 

Количество членов ряда Фурье (1) или (4), естественно, не бесконечно. Однако, коэффициенты **ak** и **bk,** или **sk** при увеличении **k** последовательно уменьшаются, и можно пренебречь всеми членами ряда, коэффициенты при которых пренебрежимо малы. Это означает, что состав сигнала ограничивается определенной самой высшей гармоникой с частотой **wmax**.

Поскольку находить коэффициенты ряда Фурье аналитически по зависимостям (3) не всегда удобно, часто прибегают к численным методам их определения.

Пусть интервал изменения функции **u(t)**, равный [**0** ¸ **T]**, разбит на **m** участков с шагом **Dt = T/m**. То есть мы имеем **m+1** дискретных значений функции **u(tj)=uj** при **tj=jDt** (j = 0, 1, 2, …m).

Тогда ряд Фурье (1) может быть приближенно заменен следующим полиномом:

![](png/007.png)		

при **n < m/2**	(6)

Искомые коэффициенты находятся по формулам:

![](png/008.png) 

и

 ![](png/009.png)  
при **(0 £ k < m/2)		(7)**

Зависимости (7) составляют основу процедуры численного определения коэффициентов Фурье. Выбор величины **m** осуществляется исходя из условия:

![](png/010.png)						(8)

где **wmax** – частота наивысшей гармоники, амплитуда которой будет вычислена.

***1.2. Комплексная форма записи ряда Фурье.***

Комплексная форма тригонометрического ряда, получается, если записать гармонические функции в (1) через комплексные экспоненты. Спектральное представление непрерывного сигнала **u(t)** в комплексной форме следующее:

![](png/011.png)						(9)

где **ck** – комплексный коэффициент ряда; **i** – мнимая единица (корень из -1)

Комплексные коэффициенты можно вычислить по формуле: 

![](png/012.png)				         (10)

Комплексная форма записи является более популярной у специалистов. Во-первых, она более экономична в смысле математических преобразований, поскольку полную информацию о сигнале несут не два набора коэффициентов, а только один – набор комплексных коэффициентов **ck**. Во-вторых, именно комплексная форма записи реализована практически во всех математических приложениях в виде подпрограмм.

Коэффициенты вещественной (4) и комплексной формы (9) связаны между собой следующим образом.

1. Модули комплексных коэффициентов **ck** определяют амплитуды гармоник:

**sk** = |**ck**|  (11)

2. Аргументы комплексных коэффициентов **ck** определяют начальные фазы гармоник:

**jk** = arg(**ck**)					        (12)

***1.3. Спектральный анализ.***

Задача спектрального анализа заключается в том, чтобы найти такие коэффициенты **ak** и **bk,** при которых ряд (1) будет сходиться к заданной функции **u(t)**. Аналогично, при использовании ряда (4) следует определять коэффициенты **sk** и **φk** . 

При использовании комплексной формы записи ряда (9) спектральный анализ ставит целью поиск значений коэффициентов **ck** . Далее нетрудно вычислить коэффициенты **sk** и **φk** с помощью выражений (11) и (12)ю 

Частоты отдельных гармоник **wk** во всех случаях определяются по формуле (2). 

В качестве примера рассмотрим отрезок сигнала, с периодом T = 0.02 сек. 

![](png/013.png)

Рис. 1. Пример периодической сигнальной функции

Было найдено, что данный сигнал является суммой четырех составляющих с частотами **wk** = {0; 0.125; 0.25; 0.375}(рад/сек).

Математическое описание данного сигнала в виде вещественного ряда (4) определяется формулой:

![](png/014.png)

где **sk** = {2; 8; 7; 2.3} - амплитуды составляющих; **jk** = {0; 0.52; -0.88; -0.46} –начальные фазовые углы (рад); **k** = 0, 1, 2, 3.

***1.4. Понятие спектра периодического сигнала.***

Возможность представления сигнала в виде ряда Фурье означает, что коэффициенты Фурье несут полную информацию о сигнале с известным периодом **T.** 

Коэффициенты **sk** , а также модули комплексного коэффициента **ck** несут информацию о том, из каких по амплитуде гармонических составляющих состоит исходный сигнал. Поэтому набор **sk** называется *амплитудным спектром* сигнала.

Коэффициенты **φk**, а также аргументы комплексного коэффициента **ck** определяют фазы отдельных составляющих. Их совокупность называется *фазовым спектром*.

Амплитудный и фазовый спектры сигнала, показанного на рис. 1, приведены ниже. Аргументом в обоих случаях является частота составляющих гармоник.

![](png/015.png)

Рис. 2 Спектральное представление периодической сигнальной функции

Так как спектр периодического сигнала (рис.2) состоит из отдельных гармоник, его называют дискретным или линейчатым.

***1.5. Спектр последовательности импульсов.***

Поскольку последовательность импульсов является периодической функцией, то ее спектр является дискретным (линейчатым), то есть состоит из отдельных гармоник, так же спектр непрерывного периодического сигнала. 

В качестве примера рассмотрим дискретную последовательность импульсов с параметрами амплитуда **U**= 1; период следования **T** = 2p; длительность импульса.**t** = p/4. 

![](png/016.png)

Рис. 3. а) – последовательность прямоугольных импульсов; 
б) – амплитудный спектр данной последовательности.

Можно заметить, что подобно спектру непрерывного сигнала здесь также все гармонические составляющие находятся на частотах, кратных частоте первой гармоники (**w**, 2**w**, 3**w** и т. д.). Но есть и существенные отличия. Во-первых, спектр последовательности импульсов является неограниченным, а во-вторых, он имеет лепестковый характер, т. е. в спектре можно выделить множество «лепестков»

***1.6. Спектр непериодических сигналов и одиночных импульсов.***

В непериодических сигналах нельзя выделить период, т. к. **Т = ¥**. Поэтому для построения спектра производят следующую процедуру: сигнал мысленно представляют как периодический с каким-либо произвольным периодом, для которого строят спектр. Затем осуществляют предельный переход, устремляя период к бесконечности (**Т ®¥**). При этом наблюдается следующий эффект. Поскольку частоты гармоник, согласно (2) обратно пропорциональны периоду **T** , то при его увеличении, например, в 3 раза, гармоники в спектре станут располагаться в три раза чаще. Поэтому, при увеличении периода частота первой гармоники и, соответственно, расстояние между гармоническими составляющими стремится к нулю (**f1=1/Т**), а все составляющие гармоники сливаются друг с другом и образуют сплошной спектр. Это показано на рис. 4.

![](png/017.png)

Рис. 4. а) – одиночный прямоугольный импульс; б) – амплитудный спектр импульса; в) – фазовый спектр импульса.

То же можно заметить при исследовании спектров непериодических сигналов произвольной формы. На рисунке 5 показан пример сигнала, заданного формулой **u(t) = exp(-0,15×t) - exp(-0,17×t)** и его амплитудный спектр.

![](png/018.png)

Рис. 5. Пример спектра непериодического сигнала

***
**2. Быстрое преобразование Фурье и его реализация в Matlab.**

***2.1. Особенности алгоритмов быстрого преобразования Фурье.***

В настоящее время для спектрального анализа обычно используются численные методы определения спектров сигнала. Однако, использование приведенных выше зависимостей (6) – (10) требует выполнения большого количества вычислительных операций. В частности установлено, что количество необходимых вычислений пропорционально **n2** , где **n** – количество определяемых точек спектра. Такая ситуация требовала значительных затрат времени даже при использовании современных компьютеров.

В этой связи была разработана группа алгоритмов, позволяющих значительно ускорить вычислительный процесс. Эти алгоритмы носят общее название «Быстрое преобразование Фурье» (Fast Fourier transform). При использовании быстрого преобразования Фурье количество необходимых вычислений удается сократить до величины, пропорциональной **n×log(n)** и тем самым получить значительный выигрыш во времени. 

Алгоритмы БПФ достаточно сложные и их детали обычно изучают те, кто занимается теоретическими вопросами цифровой обработки сигналов. Тем не менее, именно эти алгоритмы заложены в подпрограммы всех популярных математических приложений и доступны для практического использования. 

В то же время, БПФ имеет некоторые недостатки, которые, впрочем, не являются критичными на практике.

Главным здесь является ограничение, согласно которому объем входных дискретных значений функции **u(tj)** (аргумент преобразования) должен быть числом, равным целой степени двойки – **2p**. Если количество исходных данных не совпадает со степенью 2, то для запуска алгоритма БПФ можно дополнить недостающие элементы нулями.

Кроме того, алгоритм использует комплексное представление ряда Фурье (9) и результат его работы содержит не только положительные, но и отрицательные частоты. Поэтому половина результатов является «зеркальным» отображением другой половины. Это приводит к необходимости избавляться от ненужных отрицательных частот. Также могут возникать вопросы к нормировке полученного спектра по частоте и амплитуде. Но, несмотря на указанные недостатки, алгоритм БПФ получил самое широкое распространение. Вопросы, связанные с указанными недостатками будут рассмотрены ниже.

***2.2. Иллюстрация использования быстрого преобразования Фурье.***

Метод *быстрого преобразования Фурье* – Fast Fourier Transform (FFT) реализован в системе Matlab следующим образом. Для одномерного прямого преобразования используется функция fft(X). Она может быть вызвана следующим образом:

- fft(X) возвращает результат дискретного преобразования Фурье для вектора Х по возможности используя алгоритм быстрого преобразования. Если X – матрица, функция fft возвращает преобразование Фурье для каждого столбца матрицы;
- fft(X,n) возвращает результат дискретного преобразования Фурье, используя n отсчетов из вектора X. Если длина вектора X меньше n, то недостающие элементы заполняются нулями. Если длина X больше n, то лишние элементы удаляются. Когда X – матрица, длина столбцов корректируется аналогично;

Для иллюстрации использования функции fft создадим сигнал, представляющий собой сумму некоторой постоянной и трех гармонических составляющих с разной частотой и амплитудой. Начальные фазы составляющих примем равными нулю. 

%Создание сигнала и построение его графика

%Сигнал - сумма постоянной и трех гармонических колебаний

A0=0.4;A1=1;A2=0.3;A3=0.6; % амплитуды гармоник

w1=0.5;w2=5;w3=10; % частоты гармоник

Ts=6;%продолжительность сигнала

Fd=2\*pi\*20;%частота дискретизации

t=0:1/Fd:Ts;%массив отсчетов времени

% значение сигнала

u=A0+A1\*cos(2\*pi\*w1\*t)+A2\*cos(2\*pi\*w2\*t)+A3\*cos(2\*pi\*w3\*t); 

plot(t,u); %график сигнала

![](png/019.png)

Рис. 6. График созданного сигнала

Если применить к созданному сигналу функцию преобразования Фурье fft, то в качестве результата мы получим вектор комплексных чисел. Он и будет  представлением сигнала в показательной форме (9). Выше указывалось, что модули этих комплексных чисел представляют амплитуды гармоник (11), а аргументы – их начальные фазы (12). 

Попробуем просто применить к нашему сигналу преобразование Фурье и взять абсолютные значения вектора на выходе функции fft.

N=512; %количество значений сигнала

sp=abs(fft(u,N)); %преобразование Фурье

plot(sp); %вывод абсолютных значений амплитуд спектра

После выполнения приведенных операторов получается приблизительно следующий график:

![](png/020.png)

Рис. 7. Результат простого выполнения функции fft.

Полученный результат значительно отличается от наших ожиданий. Созданный сигнал состоял из константы и трех гармонических составляющих. Поэтому, следуя теории,  мы должны получить в спектре 4 пика. Однако, на приведенном рисунке 7 пиков (один из пиков, принадлежащий постоянной,  сливается с осью ординат и не заметен). Кроме того, амплитуды пиков совсем не совпадают с амплитудами исходных гармоник, а ось абсцисс отображает не частоты, а номера точек значения сигнала.

Причина в том, что алгоритм работы функции fft устроен таким образом, что перебираются не только положительные, но и отрицательные частоты и правая часть графика является «зеркальным» отображением реального спектра. То есть на самом деле 0 (которому соответствует постоянная часть сигнала) должен располагаться в середине массива. Исправить данную ситуацию можно несколькими путями. Часто рекомендуется провести циклический сдвиг результатов на половину длины массива. Для этих целей, в Matlab существует функция сдвига fftshift(), смещающая первый элемент в середину массива. Но можно просто отбросить конец исходного массива. 

Выведем только первые 100 элементов, заменив оператор plot(sp) на оператор  plot(sp(1:101)):

![](png/021.png)

Рис. 8. Первые сто значений спектра сигнала. 

Полученный результат уже похож на тот, который мы ожидаем. Однако, он еще не является окончательным.

Во-первых, аргументом на приведенном графике являются номера точек значений сигнала, но нам нужна амплитудно-частотная характеристика и по оси абсцисс следует иметь значения частоты гармоник, составляющих сигнал.

Во-вторых, по оси ординат опять приводятся какие-то непонятные значения амплитуд.

С первым достаточно просто. Зная частоту дискретизации и общее количество значений сигнала нетрудно поставить каждой точке соответствующую частоту:

f=(0:100)\*Fd/N;% Частоты спектра (Гц)

Для нормировки амплитуд следует вспомнить, что мы отбросили «зеркальную» часть графика. Поэтому весь спектр будет эквивалентен своей положительной части с удвоенной амплитудой. Исключение составляет только нулевой элемент, который не имеет зеркальной половины. Кроме того, поскольку быстрое преобразование Фурье фактически представляет собой суммирование сигнала перемноженного на комплексную экспоненту, то реальный результат будет меньше полученного ровно в столько раз, сколько было суммирований. 

Таким образом, полученный результат надо разделить на количество точек и удвоить все значения, кроме первого:

sp1=sp\*2/N;sp1(1)=sp1(1)/2;% Нормировка амплитуд

В итоге получим результат:

![](png/022.png)

Рис. 9. Окончательный результат анализа спектра. 

Анализируя результаты можно заметить, что частоты гармоник, составляющих сигнал, полностью соответствуют заданным значениям. Что же касается амплитуд, которые несколько меньше заданных, это вызвано тем обстоятельством, что алгоритм БПФ учитывает не только частоту гармоники, но и несколько соседних (слева и справа). Их наличие и приводит к некоторому уменьшению амплитуды пика.

Окончательная программа примет вид:

%Использование БПФ (функция fft)Программа 1

%Сигнал - сумма постоянной и трех гармонических колебаний

%Формирование сигнала

A0=0.4;A1=1;A2=0.3;A3=0.6; % амплитуды гармоник

w1=0.5;w2=5;w3=10; % частоты гармоник (Гц)

Ts=6;% продолжительность сигнала

Fd=2\*pi\*20;% частота дискретизации

t=0:1/Fd:Ts;% массив отсчетов времени

u=A0+A1\*cos(2\*pi\*w1\*t)+A2\*cos(2\*pi\*w2\*t)+A3\*cos(2\*pi\*w3\*t); 

%Преобразование Фурье

N=512; % количество точек (линий спектра) для fft

sp=abs(fft(u,N)); 

nf=75; % выбор количества частот, которые будут выводиться на график спектра

f=(0:nf)\*Fd/N;% Частоты спектра

sp1=sp\*2/N;sp1(1)=sp1(1)/2;% Нормировка амплитуд спектра

%Вывод результатов

figure

subplot(2,1,1)% выбор области окна

plot(t,u); % график сигнала

subplot(2,1,2)

plot(f,sp1(1:nf+1));% график спектра



![](png/023.png)

Рис. 10. Результат работы программы 1. 


***2.3. Использование преобразования Фурье
для выделения сигналов на фоне помех.***

Дискретное преобразование Фурье  удобно использовать для отделения полезных сигналов от помех и искажений, которые вносятся при передаче информации. Дело в том, что спектр случайных помех, как правило, существенно отличается от спектра полезного сигнала. На этом и основано применение анализа Фурье для очистки сигналов. 

Для иллюстрации вернемся к описанному выше примеру, где в качестве сигнала используется сумма некоторой константы и трех гармонических составляющих с разной частотой и амплитудой (рис.11). Будем считать этот сигнал полезным. 

![](png/024.png)

Рис. 11. Неискаженный сигнал. 

Добавим к данному сигналу помехи.

Известно, что в качестве модели случайных помех наиболее широко используется Гауссов шум (белый шум). Он является классической моделью стационарного случайного процесса и интересен тем, что все его спектральные составляющие имеют одинаковую энергию, а спектральная плотность равна дисперсии значений. Дисперсию шума возьмем на 50% выше, чем амплитуда самой большой составляющей. Сигнал с помехами представлен на рис.12.

![](png/025.png)

Рис. 12. Сигнал с помехами. 

Сравнивая рис. 11 и 12 можно указать, что визуально чрезвычайно трудно распознать исходный сигнал на фоне действующих помех.

Теперь проведем спектральный анализ искаженного сигнала, используя описанные выше приемы. Результат представлен на рис. 13.

![](png/026.png)

Рис. 13. Амплитудно-частотный спектр сигнала с помехами. 

На рис. 13 видно, что составляющие с частотами 0.5; 5 и 10 Гц явно выделяются на фоне хаотичного спектра помех. Можно сравнить полученный спектр и изображенный на рис. 9, где показан спектр исходного сигнала (без помех). 

Видно, что амплитуды составляющих меньше, чем у исходного сигнала, что вызвано искажениями. Однако количество составляющих, их частоты и относительное соответствие амплитуд позволяют в значительной степени восстановить исходный сигнал, очистив его от помех.




***
**3. Лабораторные работы**

***Содержание отчета по лабораторным работам***

Каждая лабораторная работа должна быть выполнена на компьютере, после чего должна быть оформлена и представлена к защите.

Отчет по лабораторной работе рекомендуется выполнять на отдельных листах, скрепляемых при сдаче.

В отчет необходимо включать полную формулировку индивидуального задания, а также следующие результаты его выполнения.

- исходные данные, 
- текст программы,
- полученные результаты, иллюстрации;
- аналитические  выводы по работе.

На защите работы студент должен продемонстрировать полное владение материалом лабораторной работы, дать исчерпывающие и точные ответы на все вопросы преподавателя, касающиеся темы выполненной работы.

***

***3.1 Лабораторная работа 1.***

***Исследование спектра непрерывного детерминированного сигнала***

*3.1.1. Варианты заданий*

С использованием преобразования Фурье определить спектр сигнала, заданного уравнением. Вывести график сигнала и его амплитудный спектр. Оценить правильность полученного результата.

1. **u=A0+A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)+ A4cos(2pw4t)**

где **Ai**: 1; 1.5; 0.8; 1.2; 0.6    **wi**: 2; 7; 12; 16

2. **u=A0(1+macos(2pw1t))×cos(2pw0t );**

где **A0** = 4;  **w0** = 200;  **w1** = 10; **ma** = 0.8

3. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3cos(2pw3t)+ A4sin(2pw4t)**

где **Ai**: 1.5; 1.2; 0.8; 1.0; 0.7    **wi**: 2; 5; 10; 12

4. **u=A0(cos(2pw0t+ mf sin(2pw1t )));**

где**A0** = 2;  **w0** = 400;  **w1** = 20; **mf** = 5

5. **u=A0(cos(2pw0t+ mf sin(2pw1t )));**

где**A0** = 2;  **w0** = 300;  **w1** = 30; **mf** = 4

6. **u=A0+ A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)+ A4cos(2pw4t)**

где **Ai**:0.2; 2.2; 1.4; 0.2; 1.7    **wi**: 5; 8; 12; 18

7. **u=A0(cos(2pw0t+ mf sin(2pw1t )));**

где**A0** = 2;  **w0** = 500;  **w1** = 40; **mf** = 4

8. **u=A0(1+masin(2pw1t))×sin(2pw0t );**

где **A0** =4;  **w0** = 150;  **w1** = 20; **ma** = 0.75

9. **u=A0+ A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)+ A4cos(2pw4t)**

где **Ai**:0.5; 1.2; 1.8; 0.8; 1.9    **wi**: 4; 7; 10; 14

10. **u=A0(1+ma(sin(2pw1t))2)×cos(2pw0t );**

где **A0** = 3;  **w0** = 150;  **w1** = 12; **ma** = 0.7

11. **u=A0(1+masin(2pw1t))×cos(2pw0t );**

где **A0** = 4;  **w0** = 100;  **w1** = 10; **ma** = 0.5

12. **u=A0(1+masin(2pw1t))×sin(2pw0t );**

где **A0** =4;  **w0** = 200;  **w1** = 20; **ma** = 0.9

13. **u=A0(cos(2pw0t+ mf sin(2pw1t )));**

где**A0** = 3;  **w0** = 350;  **w1** = 35; **mf** = 5

14. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3cos(2pw3t)+ A4sin(2pw4t)**

где **Ai**:0.5; 0.2; 1.8; 1.2; 0.7    **wi**: 3; 6; 10; 16

15. **u=A0(cos(2pw0t+ mf sin(2pw1t )));**

где**A0** = 2.5;  **w0** = 450;  **w1** = 30; **mf** = 4

*3.1.2. Рекомендации к составлению программы*

Пример программы и результат ее работы приведен выше.  Она состоит из следующих блоков: формирование сигнала из исходных данных; преобразование Фурье; вывод результатов в виде графиков.

Безусловно, приведенная в параграфе 2 программа является только одним из вариантов реализации решения задачи.

*3.1.3. Контрольные вопросы*

1. Назовите предмет и задачи спектрального анализа сигналов. 
2. Какие элементы составляют вещественную форму записи ряда Фурье. 
3. Что такое амплитудный и фазовый спектры сигнала? 
4. Какая функция системы **Matlab** используется для быстрого преобразования Фурье ?
5. Как осуществляется нормировка амплитуд при анализе результатов использования функции быстрого преобразования **fft**?


***
***3.2 Лабораторная работа 2.***

***Исследование спектра детерминированного импульсного сигнала***

*3.2.1. Варианты заданий*

С использованием преобразования Фурье определить спектр последовательности прямоугольных импульсов с заданными значениями. Вывести изображение последовательности импульсов и амплитудный спектр. Оценить правильность полученного результата.

1. Амплитуда импульсов **A** = 2; период следования **T** = 0.5;длительность импульсов **t** = 0.2  

2. Амплитуда импульсов **A** = 1;период следования **T** = 1.5; длительность импульсов **t** = 0.5 

3. Амплитуда импульсов **A** = -1.5;период следования **T** = 1.5; длительность импульсов **t** = 0.5 

4. Амплитуда импульсов **A** =1; период следования **T** = 0.5; длительность импульсов **t** = 0.1  

5. Амплитуда импульсов **A** = 3;период следования **T** = 1.0; длительность импульсов **t** = 0.2 

6. Амплитуда импульсов **A** = -0.5;период следования **T** = 0.5; длительность импульсов **t** = 0.2  

7. Амплитуда импульсов **A** = -2;период следования **T** = 1.5; длительность импульсов **t** = 0.8 

8. Амплитуда импульсов **A** = 2; период следования **T** = 1.0; длительность импульсов **t** = 0.9  

9. Амплитуда импульсов **A** = 3;период следования **T** = 2.0; длительность импульсов **t** = 0.2 

10. Амплитуда импульсов **A** = -1; период следования **T** = 0.5; длительность импульсов **t** = 0.2  

С использованием преобразования Фурье определить спектр одиночного прямоугольного импульса с заданными значениями. Вывести изображение импульса и его амплитудный спектр. Оценить правильность полученного результата.

11. Амплитуда импульса **A** = 1; длительность импульса **t** = 0.25  

12. Амплитуда импульса **A** = -1.0; длительность импульса **t** = 0.3  

13. Амплитуда импульса **A** = 2; длительность импульса **t** = 0.5  

14. Амплитуда импульса **A** = 1.5; длительность импульса **t** = 0.8  

15. Амплитуда импульса **A** = -2.0; длительность импульса **t** = 1.5  

16. Амплитуда импульса **A** = 1; длительность импульса **t** = 1.5  

17. Амплитуда импульса **A** = -1.3; длительность импульса **t** = 0.5  

18. Амплитуда импульса **A** = 3; длительность импульса **t** = 1.2  

19. Амплитуда импульса **A** = 1.2; длительность импульса **t** = 0.2  

20. Амплитуда импульса **A** = -1.0; длительность импульса **t** = 0.9  

*3.2.2. Рекомендации к составлению программы*

Формировать последовательность прямоугольных импульсов можно разными способами. Например, можно использовать функцию остатка** rem. Ее синтаксис:

rem(x, y)

Для действительных чисел x и y функция rem(x, y)вычисляет остаток от деления x на y. Для массивов чисел эта функция применяется поэлементно.

Существенным отличием от программы, составленной для предыдущей лабораторной работы, является только блок формирования сигнала. Возможный фрагмент программы, осуществляющий формирование последовательности импульсов:

%Сигнал - последовательность прямоугольных импульсов

% Фрагмент программы 2

%Формирование сигнала

A=2; % амплитуда импульсов

T = 0.5; % период импульсов

tau = 0.2; % длительность импульса

Ts=4\*T;% продолжительность сигнала

Fd=2\*pi/T\*2;%частота дискретизации

t=0:1/Fd:Ts;% массив отсчетов времени

u=A\*(rem(t,T)<tau);

Фрагменты, отвечающие за выполнение преобразования Фурье и вывод результатов, можно практически полностью заимствовать из Программы 1.

Результаты приведены на рис. 14.

![](png/027.png)

Рис. 14. Результат работы программы 2.

Для формирования одиночного импульса также возможны различные приемы. В частности, можно воспользоваться предыдущей программой и задать продолжительность сигнала меньше или равную периоду импульсов:

Ниже приведен возможный фрагмент программы, осуществляющий формирование одиночного импульса:

%Сигнал - одиночный прямоугольный импульс

% Фрагмент программы 3

%Формирование сигнала

A=2; % амплитуда импульса

T = 3; % период импульса

tau = 0.5; % длительность импульса

Ts=T;% продолжительность сигнала

![](png/028.png)

Рис. 15. Результат работы программы 3.


*3.2.4. Контрольные вопросы*

1. Как изменяется ширина спектра прямоугольного видеоимпульса с изменением его длительности?
2. В чем различие и сходство спектральных характеристик непрерывного сигнала и последовательности импульсов?
3. В чем различие спектральных характеристик последовательности импульсов и одиночного импульса?
4. В чем преимущества комплексной формы записи ряда Фурье. 
5. Что содержит вектор, получаемый в результате использования функции быстрого преобразования **fft**?


***
***3.3 Лабораторная работа 3.***

***Выделение полезного сигнала на фоне случайных помех.*** 

*3.3.1. Варианты заданий*

С использованием преобразования Фурье определить спектр полезного сигнала, искаженного случайными помехами (белый шум). Вывести графики полезного и искаженного сигналов и амплитудный спектр последнего. Оценить правильность полученного результата. Уравнение полезного сигнала, его параметры и характеристики шума заданы.

1. **u=A0+A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**: 1; 1.5; 0.8; 1.2    **wi**: 2; 7; 12 . Дисперсия шума равна 1.5

2. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3cos(2pw3t)**

где **Ai**: 1.5; 1.2; 0.8; 1.0    **wi**: 2; 5; 10. Дисперсия шума равна 1.2

3. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3cos(2pw3t)**

где **Ai**:0.5; 0.2; 1.8; 1.2    **wi**: 3; 6; 10. Дисперсия шума равна 1.1

4. **u=A0+ A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**:0.2; 2.2; 1.4; 0.2    **wi**: 5; 8; 12. Дисперсия шума равна 1.0

5. **u=A0+ A1cos(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**:0.5; 1.2; 1.8; 0.8    **wi**: 4; 7; 10. Дисперсия шума равна 1.5

6. **u=A0+A1sin(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**: 1; 1.3; 0.75; 1.3    **wi**: 2; 5; 14 . Дисперсия шума равна 1.1

7. **u=A0+ A1sin(2pw1t)+ A2sin(2pw2t)+ A3cos(2pw3t)**

где **Ai**: 1.4; 1.6; 0.8; 1.1    **wi**: 2; 4; 10. Дисперсия шума равна 1.3

8. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**:0.7; 0.9; 1.2; 1.4    **wi**: 3; 8; 10. Дисперсия шума равна 0.8

9. **u=A0+ A1cos(2pw1t)+ A2sin(2pw2t)+ A3sin(2pw3t)**

где **Ai**:0.5; 2.0; 1.2; 0.5    **wi**: 4; 8; 12. Дисперсия шума равна 1.0

10. **u=A0+ A1sin(2pw1t)+ A2cos(2pw2t)+ A3sin(2pw3t)**

где **Ai**:0.5; 1.8; 1.6; 0.4    **wi**: 2; 6; 12. Дисперсия шума равна 1.4

*3.3.2. Рекомендации к составлению программы*

В системе Matlab случайный Гауссов шум можно задать функцией randn. Она генерирует массив со случайными элементами, распределенными по нормальному (Гауссову) закону с нулевым математическим ожиданием и дисперсией, равной 1.

При выполнении данной работы удобно вызывать функцию следующим образом:

randn(size(A))

При этом функция возвращает массив того же размера, что и A. 

Программа для данной лабораторной работы схожа с ранее описанными и отличается только возможностью ввода помех в виде «белого шума».

Ниже приведен возможный фрагмент программы.

%Сигнал - сумма постоянной, трех гармонических колебаний и случайного шума

% Фрагмент программы 4

% Формирование сигнала с помехами

A0=0.4;A1=1;A2=0.3;A3=0.6; % амплитуды гармоник

w1=2\*pi\*0.5;w2=2\*pi\*5;w3=2\*pi\*10; % частоты гармоник

An=1;% дисперсия шума

Ts=6;% продолжительность сигнала

Fd=2\*pi\*20;% частота дискретизации

t=0:1/Fd:Ts;% массив отсчетов времени

% значение сигнала u=A0+A1\*cos(w1\*t)+A2\*cos(w2\*t)+A3\*cos(w3\*t)+An\*randn(size(t)); 

![](png/029.png)

Рис. 16. Результат работы программы 4.


*3.3.4. Контрольные вопросы*

1. Каковы достоинства и недостатки алгоритмов быстрого преобразования Фурье?
2. Какие входные аргументы имеет функция быстрого преобразования **fft**?
3. На каком явлении основано применение анализа Фурье для очистки сигналов от помех? 
4. Что наиболее широко используется в качестве модели случайных помех?
5. На что влияет частота дискретизации непрерывного сигнала при использовании функции быстрого преобразования **fft**?



